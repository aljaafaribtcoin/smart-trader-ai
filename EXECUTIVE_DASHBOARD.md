# لوحة التحكم التنفيذية (Executive Dashboard)

## نظرة عامة
لوحة تحكم شاملة توفر رؤية عامة وتحليلية لأداء استراتيجيات Backtesting مع مقارنات ورسوم بيانية تفاعلية.

## المميزات الرئيسية

### 1. مؤشرات الأداء الرئيسية (KPIs)
- **إجمالي الاختبارات**: عدد اختبارات Backtesting المكتملة
- **إجمالي الصفقات**: مجموع الصفقات المنفذة عبر جميع الاختبارات
- **متوسط Win Rate**: متوسط معدل النجاح عبر جميع الاختبارات
- **إجمالي العائد**: مجموع العوائد من جميع الاختبارات
- **متوسط Profit Factor**: متوسط نسبة الربح إلى الخسارة
- **نسبة الربحية**: نسبة الاختبارات الرابحة من الإجمالي

### 2. الرسوم البيانية التفاعلية

#### أ) الأداء عبر الزمن (Line Chart)
- يعرض تطور العائد ومعدل النجاح للاختبارات الـ20 الأخيرة
- خطين متداخلين للمقارنة بين العائد و Win Rate
- محور X: التاريخ
- محور Y: النسبة المئوية

#### ب) توزيع الاستراتيجيات (Pie Chart)
- يوضح نسبة استخدام كل استراتيجية
- ألوان مختلفة لكل استراتيجية (signals, patterns, indicators)
- نسب مئوية على كل قطاع

#### ج) مقارنة الاستراتيجيات (Bar Chart)
- مقارنة متوسط العائد لكل نوع استراتيجية
- محور X: نوع الاستراتيجية
- محور Y: متوسط العائد %

#### د) أفضل الرموز أداءً (Horizontal Bar Chart)
- يعرض أعلى 10 رموز من حيث العائد
- ترتيب تنازلي من الأعلى إلى الأقل
- سهل القراءة مع أسماء الرموز على المحور العمودي

### 3. جدول الإحصائيات التفصيلية
جدول شامل يحتوي على:
- نوع الاستراتيجية
- الرمز (Symbol)
- الإطار الزمني (Timeframe)
- عدد الاختبارات
- عدد الصفقات
- Win Rate
- متوسط العائد
- أفضل عائد
- Profit Factor

الجدول يعرض أفضل 20 نتيجة مرتبة حسب الأداء.

## البنية التقنية

### الملفات الجديدة

#### 1. `src/hooks/api/useBacktestStatistics.ts`
```typescript
- useBacktestStatistics(): جلب البيانات من backtest_statistics view
- useBacktestOverview(): حساب المؤشرات الإجمالية (KPIs)
```

#### 2. `src/components/ExecutiveDashboard.tsx`
المكون الرئيسي للوحة التحكم يحتوي على:
- 6 KPI Cards
- 4 رسوم بيانية تفاعلية (Recharts)
- جدول إحصائيات مفصل
- تصميم responsive يتكيف مع جميع الشاشات

#### 3. تحديث `src/pages/Dashboard.tsx`
- إضافة Tabs للتبديل بين النظرة العامة ولوحة التحكم التنفيذية
- Tab 1: النظرة العامة (الواجهة القديمة)
- Tab 2: لوحة التحكم التنفيذية (الجديدة)

## مصادر البيانات

### 1. Materialized View: `backtest_statistics`
يوفر إحصائيات مجمعة حسب:
- نوع الاستراتيجية
- الرمز
- الإطار الزمني

الأعمدة:
- total_runs: عدد الاختبارات
- total_trades_all_runs: مجموع الصفقات
- avg_win_rate: متوسط Win Rate
- avg_return: متوسط العائد
- best_return: أفضل عائد
- worst_return: أسوأ عائد
- avg_profit_factor: متوسط Profit Factor
- avg_max_drawdown: متوسط الانخفاض الأقصى

### 2. جدول `backtesting_runs`
يستخدم لحساب:
- إجمالي الاختبارات المكتملة
- مجموع الصفقات
- المتوسطات الإجمالية
- معدل الربحية

## نظام الألوان والتصميم

### الألوان الدلالية
- **Primary**: العناصر الأساسية والرئيسية
- **Success (Green)**: القيم الإيجابية والرابحة
- **Warning (Orange)**: القيم المتوسطة والتحذيرية
- **Destructive (Red)**: القيم السلبية والخاسرة

### التدرجات في الرسوم البيانية
```typescript
const COLORS = [
  'hsl(var(--primary))',    // أزرق
  'hsl(var(--success))',    // أخضر
  'hsl(var(--warning))',    // برتقالي
  'hsl(var(--destructive))' // أحمر
];
```

## الاستخدام

### الوصول إلى لوحة التحكم
1. اذهب إلى صفحة Dashboard
2. اضغط على تاب "لوحة التحكم التنفيذية"
3. استعرض المؤشرات والرسوم البيانية

### متطلبات العرض
- يجب تشغيل اختبارات Backtesting أولاً
- تحتاج إلى اختبار واحد مكتمل على الأقل
- إذا لم تكن هناك بيانات، ستظهر رسالة "لا توجد بيانات"

## الميزات التفاعلية

### Tooltips
- جميع الرسوم البيانية تحتوي على tooltips تفاعلية
- تظهر القيم التفصيلية عند التمرير
- تصميم متناسق مع نظام الألوان

### Responsive Design
- Grid system يتكيف مع حجم الشاشة
- 6 أعمدة على الشاشات الكبيرة
- 3 أعمدة على الشاشات المتوسطة
- عمودين على الشاشات الصغيرة

### Legend
- كل رسم بياني يحتوي على Legend توضيحية
- يمكن إخفاء/إظهار البيانات بالضغط على العناصر

## حالات الاستخدام

### 1. تقييم الأداء الإجمالي
- استعرض KPIs في الأعلى
- قارن مع أهدافك المحددة
- حدد مجالات التحسين

### 2. مقارنة الاستراتيجيات
- استخدم رسم Bar Chart للمقارنة
- حدد الاستراتيجية الأفضل أداءً
- ركز على الاستراتيجيات الرابحة

### 3. اختيار الرموز
- راجع رسم Top Symbols
- حدد الرموز الأكثر ربحية
- تجنب الرموز ذات الأداء الضعيف

### 4. تحليل التطور الزمني
- استخدم Line Chart للأداء عبر الزمن
- تتبع تحسن أو تدهور النتائج
- حدد الاتجاهات والأنماط

## التحديثات المستقبلية المقترحة

### 1. تصدير التقارير
- PDF Reports مع جميع الرسوم البيانية
- Excel Export للبيانات الخام
- صور PNG/SVG للرسوم البيانية

### 2. فلاتر متقدمة
- فلترة حسب التاريخ
- فلترة حسب الاستراتيجية
- فلترة حسب الرمز أو الإطار الزمني

### 3. مقارنات أكثر تفصيلاً
- مقارنة بين فترات زمنية
- مقارنة Portfolio Performance
- Heat Maps للعلاقات بين المتغيرات

### 4. تنبيهات ذكية
- تنبيهات عند انخفاض الأداء
- اقتراحات لتحسين الاستراتيجيات
- توصيات تلقائية

## الخلاصة
لوحة التحكم التنفيذية توفر رؤية شاملة وتحليلية لأداء استراتيجيات Backtesting مع واجهة مستخدم احترافية وتفاعلية، تساعد المتداولين على اتخاذ قرارات مستنيرة بناءً على البيانات الفعلية.
